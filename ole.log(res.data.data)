[1mdiff --git a/controllers/AuthController.js b/controllers/AuthController.js[m
[1mindex d440ee0..ad45f4c 100644[m
[1m--- a/controllers/AuthController.js[m
[1m+++ b/controllers/AuthController.js[m
[36m@@ -3,6 +3,7 @@[m [mconst jwt = require('jsonwebtoken');[m
 const bcrypt = require('bcrypt');[m
 const Users = require('../models').user;[m
 const Followers = require('../models').follower;[m
[32m+[m[32mconst Twits = require('../models').twit;[m
 const { response } = require('oba-http-response');[m
 const mailer = require("../helpers/mailer");[m
 const randomId = require('oba-random-id');[m
[36m@@ -89,7 +90,8 @@[m [mexports.getUsers = async(req, res) => {[m
                     },[m
                     {model: Users, as: 'following',[m
                     attributes: ['id', 'name', 'username', 'email', 'imageUrl', 'bio', 'dob', 'location', 'mobile'],[m
[31m-                    }[m
[32m+[m[32m                    },[m
[32m+[m[32m                    {model: Twits, as: 'twits', where: { isDeleted: false }}[m
                   ][m
             });[m
             response(res, 200, { count: users.length, users }, null, 'List of users');[m
[36m@@ -174,13 +176,13 @@[m [mexports.getAllUserEmails = async(req, res) => {[m
 }; [m
 [m
 exports.updateUserInfo = async(req, res) => {[m
[31m-    let { userId, name, bio, location, dob, mobile } = req.body;[m
[32m+[m[32m    let { userId, name, username, bio, location, dob, mobile } = req.body;[m
 [m
     try {[m
[31m-        if(!(name || bio || location || dob || mobile)) return response(res, 400, null, 'Please supply missing input(s)');[m
[32m+[m[32m        // if(!(name || bio || location || dob || mobile)) return response(res, 400, null, 'Please supply missing input(s)');[m
         const users = await Users.findByPk(userId);[m
         if(!users) response(res, 400, null, null, 'User not found');[m
[31m-            await Users.update({name, bio, location, dob, mobile}, {where: {id: userId}});[m
[32m+[m[32m            await Users.update({name, username, bio, location, dob, mobile}, {where: {id: userId}});[m
             const user = await Users.findOne({[m
                 where: {[m
                     id: userId[m
[36m@@ -197,6 +199,34 @@[m [mexports.updateUserInfo = async(req, res) => {[m
             })[m
             response(res, 200, user, null, 'User information updated successfully');[m
         }catch(error) {[m
[31m-            response(res, 500, null, error.message, 'Error in verifying user accounts');[m
[32m+[m[32m            response(res, 500, null, error.message, 'Error in updating user info');[m
[32m+[m[32m        }[m
[32m+[m[32m};[m[41m [m
[32m+[m
[32m+[m[32mexports.updateUserImageUrl = async(req, res) => {[m
[32m+[m[32m    let { userId, imageUrl } = req.body;[m
[32m+[m[32mconsole.log(req.body)[m
[32m+[m[32m    try {[m
[32m+[m[32m        if(!imageUrl) return response(res, 400, null, 'Please supply missing input(s)');[m
[32m+[m[32m        const users = await Users.findByPk(userId);[m
[32m+[m[32m        if(!users) response(res, 400, null, null, 'User not found');[m
[32m+[m[32m            await Users.update({imageUrl}, {where: {id: userId}});[m
[32m+[m[32m            const user = await Users.findOne({[m
[32m+[m[32m                where: {[m
[32m+[m[32m                    id: userId[m
[32m+[m[32m                },[m
[32m+[m[32m                attributes: ['id', 'name', 'username', 'email', 'imageUrl', 'createdAt', 'bio', 'location', 'dob', 'mobile'],[m
[32m+[m[32m                include: [[m
[32m+[m[32m                    {model: Users, as: 'followers',[m
[32m+[m[32m                    attributes: ['id', 'name', 'username', 'email', 'imageUrl', 'bio', 'location', 'dob', 'mobile'],[m
[32m+[m[32m                    },[m
[32m+[m[32m                    {model: Users, as: 'following',[m
[32m+[m[32m                    attributes: ['id', 'name', 'username', 'email', 'imageUrl', 'bio', 'location', 'dob', 'mobile'],[m
[32m+[m[32m                    }[m
[32m+[m[32m                  ][m
[32m+[m[32m            })[m
[32m+[m[32m            response(res, 200, user, null, 'User ImageURL updated successfully');[m
[32m+[m[32m        }catch(error) {[m
[32m+[m[32m            response(res, 500, null, error.message, 'Error in updating user imageURL');[m
         }[m
 }; [m
\ No newline at end of file[m
[1mdiff --git a/routes/AuthRoutes.js b/routes/AuthRoutes.js[m
[1mindex c138be5..08dc107 100644[m
[1m--- a/routes/AuthRoutes.js[m
[1m+++ b/routes/AuthRoutes.js[m
[36m@@ -11,5 +11,6 @@[m [mrouter.get('/verify/:username', AuthController.verifyUser);[m
 router.post('/verify/all', AuthController.verifyUsers);[m
 router.get('/emails', AuthController.getAllUserEmails);[m
 router.patch('/update', checkAuth, AuthController.updateUserInfo);[m
[32m+[m[32mrouter.patch('/imageurl/update', checkAuth, AuthController.updateUserImageUrl);[m
 [m
 module.exports = router;[m
\ No newline at end of file[m
[1mdiff --git a/ui/src/components/GoogleAuth.js b/ui/src/components/GoogleAuth.js[m
[1mindex 1cde664..47edf76 100644[m
[1m--- a/ui/src/components/GoogleAuth.js[m
[1m+++ b/ui/src/components/GoogleAuth.js[m
[36m@@ -28,7 +28,8 @@[m [mexport default function GoogleAuth(props) {[m
         <div>[m
             <GoogleLogin [m
                 clientId={clientId}[m
[31m-                buttonText={signup ? 'Signup with Google' : 'Login with Google'}[m
[32m+[m[32m                // buttonText={signup ? 'Signup with Google' : 'Login with Google'}[m
[32m+[m[32m                buttonText='Use Google'[m
                 onSuccess={onSuccess}[m
                 onFailure={onFailure}[m
                 // isSignedIn={true}[m
[1mdiff --git a/ui/src/components/Posts.js b/ui/src/components/Posts.js[m
[1mindex 848f6c6..a737a7f 100644[m
[1m--- a/ui/src/components/Posts.js[m
[1m+++ b/ui/src/components/Posts.js[m
[36m@@ -8,15 +8,18 @@[m [mimport GoogleAuth from './GoogleAuth';[m
 import { baseUrl } from '../helper';[m
 // import LinkedinAuth from './LinkedinAuth';[m
 import dotenv from "dotenv";[m
[31m-import chat from './chat.jpg';[m
[31m-import bg from './bg.png';[m
[31m-import { CgCopyright } from 'react-icons/cg';[m
[32m+[m[32mimport store from '../redux/store';[m
[32m+[m[32mimport { useSelector } from 'react-redux';[m
 [m
 dotenv.config();[m
 const clientId = process.env.REACT_APP_GOOGLE_CLIENT_ID;[m
 [m
 export const authenticate = async(google = false, email, password = null, apiUrl, error, setError, setLoading, history, name, imageUrl) => {[m
     localStorage.setItem('img', imageUrl);[m
[32m+[m[41m    [m
[32m+[m[32m    const {getState, dispatch} = store;[m
[32m+[m[32m    const state = getState();[m
[32m+[m
     setLoading(true);[m
     let res;[m
     if(!google) {[m
[36m@@ -57,7 +60,11 @@[m [mexport const authenticate = async(google = false, email, password = null, apiUrl[m
             }[m
         })[m
         .catch(error => {[m
[31m-            setError(error.response.data.error);[m
[32m+[m[32m            if(error.response.data.error.search('connect') >= 0) {[m
[32m+[m[32m                setError('Please check your network');[m
[32m+[m[32m            } else {[m
[32m+[m[32m                setError(error.response.data.error);[m
[32m+[m[32m            }[m
         });[m
 [m
     }[m
[36m@@ -67,6 +74,10 @@[m [mexport const authenticate = async(google = false, email, password = null, apiUrl[m
             localStorage.setItem('userId', res.data.data.user.id);[m
             localStorage.setItem('username', res.data.data.user?.username);[m
             localStorage.setItem('token', res.data.data.token);[m
[32m+[m[32m            dispatch({[m
[32m+[m[32m                type: 'SET_USER_DATA',[m
[32m+[m[32m                data: res.data.data.user[m
[32m+[m[32m            });[m
             setLoading(false);[m
             history.push('/twits');[m
         } else {[m
[1mdiff --git a/ui/src/components/Profile.js b/ui/src/components/Profile.js[m
[1mindex b3d4399..fec4ee4 100644[m
[1m--- a/ui/src/components/Profile.js[m
[1m+++ b/ui/src/components/Profile.js[m
[36m@@ -3,7 +3,7 @@[m
 import React, { useEffect, useState } from 'react';[m
 import { useParams, useHistory } from "react-router-dom";[m
 import { BsPersonFill } from 'react-icons/bs';[m
[31m-import { IoIosArrowBack, IoIosPeople, IoMdCloudUpload } from 'react-icons/io';[m
[32m+[m[32mimport { IoIosArrowBack, IoIosPeople } from 'react-icons/io';[m
 import { GrEdit, GrUploadOption } from 'react-icons/gr';[m
 import Moment from 'react-moment';[m
 import axios from 'axios';[m
[36m@@ -17,8 +17,14 @@[m [mimport { ToastContainer, toast } from 'react-toastify';[m
 import 'react-toastify/dist/ReactToastify.css';[m
 [m
 export default function Profile() {[m
[32m+[m[32m    const email = localStorage.getItem('email') ? localStorage.getItem('email') : '';[m
[32m+[m[32m    const token = localStorage.getItem('token');[m
[32m+[m[32m    const {getState, dispatch} = store;[m
[32m+[m[32m    const state = getState();[m
[32m+[m[32m    const { twits, userData } = useSelector(state => state);[m
[32m+[m
     const [error, setError] = useState('');[m
[31m-    const [ userData, setUserData ] = useState({});[m
[32m+[m[32m    // const [ luserData, setlUserData ] = useState(userData);[m
     const [ isFollower, setIsFollower ] = useState(false);[m
     const [ isFollowing, setIsFollowing ] = useState(false);[m
     const [ followerCount, setFollowerCount ] = useState(0);[m
[36m@@ -26,16 +32,16 @@[m [mexport default function Profile() {[m
     const [ twitCount, setTwitCount ] = useState(0);[m
     const [followLoading, setFollowLoading] = useState(false);[m
     const [sync, setSync] = useState(false);[m
[32m+[m[32m    const [imgUrl, setImgUrl] = useState('');[m
     let { user } = useParams();[m
     const history = useHistory();[m
 [m
[31m-    const email = localStorage.getItem('email') ? localStorage.getItem('email') : '';[m
[31m-    const token = localStorage.getItem('token');[m
[31m-    const {getState, dispatch} = store;[m
[31m-    const state = getState();[m
[31m-    const { twits } = useSelector(state => state);[m
 [m
     const apiCallHook = async(method, url, data) => {[m
[32m+[m[32m        console.log(data)[m
[32m+[m[32m        if(data?.username) {[m
[32m+[m[32m            history.push(`/${data.username}`)[m
[32m+[m[32m        }[m
         const res = await axios({[m
             method,[m
             url,[m
[36m@@ -47,12 +53,12 @@[m [mexport default function Profile() {[m
             })[m
             .catch(error => {[m
                 if(error.isAxiosError) {[m
[32m+[m[32m                    console.log(error.response?.data?.error);[m
                     setError(error.response?.data?.error);[m
                 }[m
             });[m
             if(res && res.data.success) {[m
[31m-                // console.log(res.data)[m
[31m-                    if(method === 'GET') {[m
[32m+[m[32m                if(method === 'GET') {[m
                     dispatch({[m
                         type: 'SET_USERS_DATA',[m
                         data: res.data.data.users[m
[36m@@ -60,17 +66,24 @@[m [mexport default function Profile() {[m
                     localStorage.setItem('usersData', JSON.stringify(res.data.data.users));[m
                     localStorage.setItem('users', JSON.stringify(res.data.data.users));[m
                     const userTwits = twits.filter(obj => obj.twits.username === user);[m
[32m+[m[32m                    console.log(res.data.data.users)[m
                     const userDataInStore = res.data.data.users.filter(obj => obj.username === user)[0];[m
[32m+[m[32m                    dispatch({[m
[32m+[m[32m                        type: 'SET_USER_DATA',[m
[32m+[m[32m                        data: userDataInStore[m
[32m+[m[32m                    });[m
[32m+[m[32m                    console.log(userDataInStore)[m
                     const followers = userDataInStore.followers.filter(user => user.follower.isFollowed);[m
                     const following = userDataInStore.following.filter(user => user.follower.isFollowed);[m
                     const checkIsFollower = followers.filter(user => user.email === email).length > 0;[m
                     const checkIsFollowing = following.filter(user => user.email === email).length > 0;[m
[31m-                    setUserData(userDataInStore);[m
[32m+[m[32m                    // setUserData(userDataInStore);[m
                     setFollowerCount(followers.length);[m
                     setFollowingCount(following.length);[m
                     setIsFollower(checkIsFollower);[m
                     setIsFollowing(checkIsFollowing);[m
[31m-                    setTwitCount(userTwits.length);[m
[32m+[m[32m                    // setTwitCount(userTwits.length);[m
[32m+[m[32m                    setTwitCount(userDataInStore?.twits?.length || 0);[m[41m       [m
 [m
                     setError('');[m
                 } else{[m
[36m@@ -89,12 +102,17 @@[m [mexport default function Profile() {[m
                 const following = userDataInStore?.following.filter(user => user.follower.isFollowed);[m
                 const checkIsFollower = followers?.filter(user => user.email === email).length > 0;[m
                 const checkIsFollowing = following?.filter(user => user.email === email).length > 0;[m
[31m-                setUserData(userDataInStore);[m
[32m+[m[32m                dispatch({[m
[32m+[m[32m                    type: 'SET_USER_DATA',[m
[32m+[m[32m                    data: userDataInStore[m
[32m+[m[32m                });[m
[32m+[m[32m                // setUserData(userDataInStore);[m
                 setFollowerCount(followers?.length);[m
                 setFollowingCount(following?.length);[m
                 setIsFollower(checkIsFollower);[m
                 setIsFollowing(checkIsFollowing);[m
[31m-                setTwitCount(userTwits?.length);         [m
[32m+[m[32m                // setTwitCount(userTwits?.length);[m[41m         [m
[32m+[m[32m                setTwitCount(userDataInStore.twits.length);[m[41m       [m
             }[m
     }[m
 [m
[36m@@ -158,7 +176,6 @@[m [mexport default function Profile() {[m
     [m
         return () => {}[m
     }, []);[m
[31m- [m
     return ([m
         <div id={`${user}`} style={{fontSize: '1.1em'}} className='shadow-lg border border-gray-200 h-full rounded p-2 mb-4 m-auto justify-center md:w-1/2'>[m
         <p className='flex justify-between mb-6 border-3 border shadow-md p-2'>[m
[36m@@ -167,7 +184,7 @@[m [mexport default function Profile() {[m
             <span className='bg-black-400 cursor-pointer' onClick={() => history.push("/twits")}><AiFillHome size={28} /></span>[m
         </p>[m
         <ToastContainer />[m
[31m-        {!userData.username ? [m
[32m+[m[32m        {(userData?.username !== user) ?[m[41m [m
         <div className='flex justify-center items-center pt-8'>[m
             <Loader [m
             type='Bars'[m
[36m@@ -179,7 +196,7 @@[m [mexport default function Profile() {[m
         <>[m
             <div className='mb-1 flex justify-between'>[m
                 <>[m
[31m-                    <AttachProfileImage imgUrl={userData?.imageUrl} setImgUrl error={error} />[m
[32m+[m[32m                    <AttachProfileImage imgUrl={userData?.imageUrl} setImgUrl={setImgUrl} error={error} apiCallHook={apiCallHook} email={email} userData={userData} />[m
                     {/* {userData?.imageUrl ?[m
                     <span className='flex'>[m
                         {error ? <span className='flex bg-gray-300 p-3 rounded'>[m
[36m@@ -221,7 +238,7 @@[m [mexport default function Profile() {[m
                         Follows you[m
                     </span>}[m
                 </span>[m
[31m-                <span className='flex'>[m
[32m+[m[32m                <span className='flex'>[m[41m [m
                 {(email !== userData?.email) && [m
                     <>[m
                     {!followLoading ? [m
[36m@@ -237,7 +254,7 @@[m [mexport default function Profile() {[m
                 }[m
                 </span>[m
             </span>[m
[31m-            {(email === userData?.email) && [m
[32m+[m[32m            {(email === userData.email) &&[m[41m [m
                 <span className={'text-sm text-white bg-gray-900 rounded hover:bg-gray-400 p-2 cursor-pointer mr-3 mt-5'}  onClick= {e => history.push(`/chats/${user}`)}> [m
                     Messages[m
                 </span>[m
[36m@@ -254,10 +271,11 @@[m [mexport default function Profile() {[m
 [m
 [m
 const UserProfile = ({userData, email, apiCallHook}) => {[m
[31m-    const {name, bio, location, mobile, dob} = userData;[m
[32m+[m[32m    const {name, username, bio, location, mobile, dob} = userData;[m
 [m
     const [editForm, setEditForm] = useState(false);[m
     const [lname, setName] = useState(name);[m
[32m+[m[32m    const [lusername, setUsername] = useState(username);[m
     const [lbio, setBio] = useState(bio);[m
     const [llocation, setLocation] = useState(location);[m
     const [ldob, setDob] = useState(dob);[m
[36m@@ -266,13 +284,15 @@[m [mconst UserProfile = ({userData, email, apiCallHook}) => {[m
     const editProfile = () => {[m
         setEditForm(!editForm);[m
         if(editForm) {[m
[31m-            apiCallHook('PATCH', `${baseUrl}/auth/update`, {name: lname, bio: lbio, location: llocation, dob: ldob, mobile: lmobile});[m
[32m+[m[32m            apiCallHook('PATCH', `${baseUrl}/auth/update`, {name: lname, username: lusername, bio: lbio, location: llocation, dob: ldob, mobile: lmobile});[m
         }[m
     }[m
 [m
     const handleProfileInfo = (e) => {[m
         if(e.target.name === 'name') {[m
             setName(e.target.value);[m
[32m+[m[32m        } else if(e.target.name === 'username') {[m
[32m+[m[32m            setUsername(e.target.value);[m
         } else if(e.target.name === 'bio') {[m
             setBio(e.target.value);[m
         } else if(e.target.name === 'location') {[m
[36m@@ -286,114 +306,141 @@[m [mconst UserProfile = ({userData, email, apiCallHook}) => {[m
 [m
     return ([m
         <div className='text-md border border-t-1 shadow-md rounded mt-2'>[m
[31m-        <div className='flex mt-2 justify-between'>[m
[31m-            <span className='ml-2 underline'>Profile Information</span>[m
[31m-            {(email === userData?.email) &&[m
[31m-            <>[m
[31m-                {!editForm && <span className=' flex cursor-pointer text-black p-2 rounded-full justify-items-end' onClick={() => editProfile()}> [m
[31m-                    <GrEdit size={18} /> <span className='text-sm ml-1'>Edit</span>[m
[31m-                </span>}[m
[31m-                {editForm && <span className='flex cursor-pointer text-black p-2 rounded-full' onClick={() => editProfile()}> [m
[31m-                    <GrUploadOption size={18} /><span className='text-sm ml-1'>Update</span>[m
[31m-                </span>}[m
[31m-            </>[m
[31m-            }[m
[31m-        </div>[m
[31m-        <label htmlFor="Name" className='px-2 font-bold'> Name</label><br />[m
[31m-        {editForm && <input[m
[31m-          type="text"[m
[31m-          name="name"[m
[31m-          value={lname ? lname : name}[m
[31m-          style={{width: '16em'}}[m
[31m-          onChange={handleProfileInfo}[m
[31m-          placeholder="Your name"[m
[31m-          className='p-1 my-1 rounded'[m
[31m-          />}[m
[31m-        {!editForm && <div className='px-2'>{lname ? lname : name ? name : 'Not available'}</div>}[m
[31m-          <br />[m
[31m-        <label htmlFor="Bio" className='px-2 font-bold'>Bio</label><br />[m
[31m-        {editForm && <textarea[m
[31m-          type="textarea"[m
[31m-          name="bio"[m
[31m-          value={lbio ? lbio : bio}[m
[31m-          rows={4}[m
[31m-          cols={3}[m
[31m-          style={{width: '18em', height: '8em'}}[m
[31m-          onChange={handleProfileInfo} [m
[31m-          placeholder="Tell the world briefly about yourself"[m
[31m-          className='text-sm p-1 my-1 rounded'[m
[31m-          />}[m
[31m-        {!editForm && <div className='px-2'>{lbio ? lbio : bio  ? bio : 'Not available'}</div>}[m
[31m-          <br />[m
[31m-        <label htmlFor="Location" className='px-2 font-bold'> Location</label><br />[m
[31m-        {editForm && <input[m
[31m-          type="text"[m
[31m-          name="location"[m
[31m-          value={llocation ? llocation : location}[m
[31m-          style={{width: '16em'}}[m
[31m-          onChange={handleProfileInfo}[m
[31m-          placeholder="Share your location"[m
[31m-          className='p-1 my-1 rounded'[m
[31m-          />}[m
[31m-        {!editForm && <div className='px-2'>{llocation ? llocation : location ? location : 'Not available'}</div>}[m
[31m-          <br />[m
[31m-          <label htmlFor="Date of Birth" className='px-2 font-bold'> Date of Birth</label><br />[m
[31m-        {editForm && <input[m
[31m-          type="date"[m
[31m-          name="date-of-birth"[m
[31m-          value={ldob ? ldob : dob}[m
[31m-          style={{width: '16em'}}[m
[31m-          onChange={handleProfileInfo}[m
[31m-          placeholder="Date of Birth"[m
[31m-          className='p-1 my-1 rounded'[m
[31m-          />}[m
[31m-        {!editForm && <div className='px-2'>{ldob ? ldob : dob ? dob : 'Not available'}</div>}[m
[31m-          <br />[m
[31m-        <label htmlFor="Phone Number" className='px-2 font-bold'> Phone Number</label><br />[m
[31m-        {editForm && <input[m
[31m-          name="mobile"[m
[31m-          value={lmobile ? lmobile : mobile}[m
[31m-          type="tel"[m
[31m-          pattern="/^[0]\d{10, 12}$/"[m
[31m-          style={{width: '16em'}}[m
[31m-          onChange={handleProfileInfo}[m
[31m-          placeholder="Drop your mobile number "[m
[31m-          className='p-1 my-1 rounded'[m
[31m-        />}[m
[31m-        {!editForm && <div className='px-2'>{lmobile ? lmobile : mobile ? mobile : 'Not available'}</div>}[m
[32m+[m[32m            <div className='flex mt-2 justify-between'>[m
[32m+[m[32m                <span className='ml-2 underline'>Profile Information</span>[m
[32m+[m[32m                {(email === userData?.email) &&[m
[32m+[m[32m                <>[m
[32m+[m[32m                    {!editForm && <span className=' flex cursor-pointer text-black p-2 rounded-full justify-items-end' onClick={() => editProfile()}>[m[41m [m
[32m+[m[32m                        <GrEdit size={18} /> <span className='text-sm ml-1'>Edit</span>[m
[32m+[m[32m                    </span>}[m
[32m+[m[32m                    {editForm && <span className='flex cursor-pointer text-black p-2 rounded-full' onClick={() => editProfile()}>[m[41m [m
[32m+[m[32m                        <GrUploadOption size={18} /><span className='text-sm ml-1'>Update</span>[m
[32m+[m[32m                    </span>}[m
[32m+[m[32m                </>[m
[32m+[m[32m                }[m
[32m+[m[32m            </div>[m
[32m+[m[32m            <div className='mt-2'>[m
[32m+[m[32m                <label htmlFor="Name" className='px-2 font-bold'> Name</label><br />[m
[32m+[m[32m                {editForm && <input[m
[32m+[m[32m                type="text"[m
[32m+[m[32m                name="name"[m
[32m+[m[32m                value={lname ? lname : name}[m
[32m+[m[32m                style={{width: '16em'}}[m
[32m+[m[32m                onChange={handleProfileInfo}[m
[32m+[m[32m                placeholder="Your name"[m
[32m+[m[32m                className='p-1 my-1 rounded'[m
[32m+[m[32m                />}[m
[32m+[m[32m                {!editForm && <div className='px-2'>{lname ? lname : name ? name : 'Not available'}</div>}[m
[32m+[m[32m                {/* <br /> */}[m
[32m+[m[32m            </div>[m
[32m+[m[32m            <div className='mt-2'>[m
[32m+[m[32m                <label htmlFor="Username" className='px-2 font-bold'> Username</label><br />[m
[32m+[m[32m                {editForm && <input[m
[32m+[m[32m                type="text"[m
[32m+[m[32m                name="username"[m
[32m+[m[32m                value={lusername ? lusername : username}[m
[32m+[m[32m                style={{width: '16em'}}[m
[32m+[m[32m                onChange={handleProfileInfo}[m
[32m+[m[32m                placeholder="Your username"[m
[32m+[m[32m                className='p-1 my-1 rounded'[m
[32m+[m[32m                />}[m
[32m+[m[32m                {!editForm && <div className='px-2'>{lusername ? lusername : username ? username : 'Not available'}</div>}[m
[32m+[m[32m                {/* <br /> */}[m
[32m+[m[32m            </div>[m
[32m+[m[32m            <div className='mt-2'>[m
[32m+[m[32m                <label htmlFor="Bio" className='px-2 font-bold'>Bio</label><br />[m
[32m+[m[32m                {editForm && <textarea[m
[32m+[m[32m                type="textarea"[m
[32m+[m[32m                name="bio"[m
[32m+[m[32m                value={lbio ? lbio : bio}[m
[32m+[m[32m                rows={4}[m
[32m+[m[32m                cols={3}[m
[32m+[m[32m                style={{width: '18em', height: '8em'}}[m
[32m+[m[32m                onChange={handleProfileInfo}[m[41m [m
[32m+[m[32m                placeholder="Tell the world briefly about yourself"[m
[32m+[m[32m                className='text-sm p-1 my-1 rounded'[m
[32m+[m[32m                />}[m
[32m+[m[32m                {!editForm && <div className='px-2'>{lbio ? lbio : bio  ? bio : 'Not available'}</div>}[m
[32m+[m[32m                {/* <br /> */}[m
[32m+[m[32m            </div>[m
[32m+[m[32m            <div className='mt-2'>[m
[32m+[m[32m                <label htmlFor="Location" className='px-2 font-bold'> Location</label><br />[m
[32m+[m[32m                {editForm && <input[m
[32m+[m[32m                type="text"[m
[32m+[m[32m                name="location"[m
[32m+[m[32m                value={llocation ? llocation : location}[m
[32m+[m[32m                style={{width: '16em'}}[m
[32m+[m[32m                onChange={handleProfileInfo}[m
[32m+[m[32m                placeholder="Share your location"[m
[32m+[m[32m                className='p-1 my-1 rounded'[m
[32m+[m[32m                />}[m
[32m+[m[32m                {!editForm && <div className='px-2'>{llocation ? llocation : location ? location : 'Not available'}</div>}[m
[32m+[m[32m                {/* <br /> */}[m
[32m+[m[32m            </div>[m
[32m+[m[32m            <div className='mt-2'>[m
[32m+[m[32m                <label htmlFor="Date of Birth" className='px-2 font-bold'> Date of Birth</label><br />[m
[32m+[m[32m                {editForm && <input[m
[32m+[m[32m                type="date"[m
[32m+[m[32m                name="date-of-birth"[m
[32m+[m[32m                value={ldob ? ldob : dob}[m
[32m+[m[32m                style={{width: '16em'}}[m
[32m+[m[32m                onChange={handleProfileInfo}[m
[32m+[m[32m                placeholder="Date of Birth"[m
[32m+[m[32m                className='p-1 my-1 rounded'[m
[32m+[m[32m                />}[m
[32m+[m[32m                {!editForm && <div className='px-2'>{ldob ? ldob : dob ? dob : 'Not available'}</div>}[m
[32m+[m[32m                {/* <br /> */}[m
[32m+[m[32m            </div>[m
[32m+[m[32m            <div className='mt-2'>[m
[32m+[m[32m                <label htmlFor="Phone Number" className='px-2 font-bold'> Phone Number</label><br />[m
[32m+[m[32m                {editForm && <input[m
[32m+[m[32m                name="mobile"[m
[32m+[m[32m                value={lmobile ? lmobile : mobile}[m
[32m+[m[32m                type="tel"[m
[32m+[m[32m                pattern="/^[0]\d{10, 12}$/"[m
[32m+[m[32m                style={{width: '16em'}}[m
[32m+[m[32m                onChange={handleProfileInfo}[m
[32m+[m[32m                placeholder="Drop your mobile number "[m
[32m+[m[32m                className='p-1 my-1 rounded'[m
[32m+[m[32m                />}[m
[32m+[m[32m                {!editForm && <div className='px-2'>{lmobile ? lmobile : mobile ? mobile : 'Not available'}</div>}[m
[32m+[m[32m            </div>[m
       </div>[m
     )[m
 }[m
 [m
[31m-function AttachProfileImage({imgUrl, imageUrl, setImgUrl, error}) {[m
[32m+[m[32mfunction AttachProfileImage({error, apiCallHook, email, userData}) {[m
     [m
[31m-    const [uploading, setUploading] = useState("");[m
[32m+[m[32m    const [uploading, setUploading] = useState(false);[m
[32m+[m[32m    const [imgUrl, setImgUrl] = useState('');[m
 [m
[31m-    // console.log(imgUrl)[m
     const handleImage = async(e) => {[m
[31m-        setUploading("loading");[m
[32m+[m[32m        setUploading(true);[m
         const serviceImage = e.target.files[0];[m
         const data = new FormData();[m
         const url = "https://api.cloudinary.com/v1_1/thevetdoctor/image/upload";[m
         data.append("file", serviceImage);[m
         data.append("upload_preset", "zunt8yrw");[m
[31m-        // const res = await fetch(url, {[m
[31m-        //   method: "POST",[m
[31m-        //   body: data[m
[31m-        // });[m
[31m-        // const imgLink = await res.json();[m
[31m-        // setImgUrl(imgLink.secure_url);[m
[31m-        // setImgUrl(imgUrl);[m
[31m-        console.log('imgLink.secure_url');[m
[31m-        setUploading("done");[m
[32m+[m[32m        const res = await fetch(url, {[m
[32m+[m[32m          method: "POST",[m
[32m+[m[32m          body: data[m
[32m+[m[32m        });[m
[32m+[m[32m        const imgLink = await res.json();[m
[32m+[m[32m        // const imgLink = {secure_url: 'https://res.cloudinary.com/thevetdoctor/image/upload/v1615897909/bmh/BMH%20Images/buildit/planning.png'};[m
[32m+[m[32m        setImgUrl(imgLink.secure_url);[m
[32m+[m[32m        console.log(imgLink.secure_url);[m
[32m+[m[32m        setUploading(false);[m
[32m+[m[32m        await apiCallHook('PATCH', `${baseUrl}/auth/imageurl/update`, {imageUrl: imgLink.secure_url});[m
[32m+[m
       }[m
     return ([m
         <div className="flex p-1 rounded ml-1">[m
[32m+[m[32m        {!uploading ?[m
             <label className='-ml-2 -mr-5 cursor-pointer flex'>[m
[31m-            {imgUrl ?[m
[32m+[m[32m            {(imgUrl || userData?.imageUrl) ?[m
                 <>[m
                 {!error ? [m
[31m-                    <img src={imgUrl} alt='avatar' style={{width: '6em', height: '6em', borderRadius: '10%'}} className='rounded -mr-2'[m
[32m+[m[32m                    <img src={imgUrl ? imgUrl : userData?.imageUrl} alt='avatar' style={{width: '6em', height: '6em', borderRadius: '10%'}} className='rounded -mr-2'[m
                     />:[m
                     <span className='flex bg-gray-300 p-3 rounded'>[m
                         <BsPersonFill size={80} />[m
[36m@@ -405,22 +452,25 @@[m [mfunction AttachProfileImage({imgUrl, imageUrl, setImgUrl, error}) {[m
                     <BsPersonFill size={80} />[m
                 </span>[m
             </>[m
[31m-            //   {uploading === "loading" &&[m
[31m-            //   <Loader [m
[31m-            //       type='TailSpin'[m
[31m-            //       color='#000'[m
[31m-            //       height={20} [m
[31m-            //       width={20} [m
[31m-            //   />}[m
             }[m
[32m+[m[41m            [m
[32m+[m[32m            {(email === userData?.email) &&[m
             <input [m
                 type="file"[m
                 placeholder=""[m
                 accept="image/*;capture"[m
                 className="hidden"[m
                 onChange={e => handleImage(e)}[m
[32m+[m[32m            />}[m
[32m+[m[32m        </label>:[m
[32m+[m[32m            <Loader[m[41m [m
[32m+[m[32m                type='TailSpin'[m
[32m+[m[32m                color='#fff'[m
[32m+[m[32m                height={60}[m[41m [m
[32m+[m[32m                width={60}[m[41m [m
[32m+[m[32m                className='m-auto ml-8 -mb-1 bg-blue-300 w-30 rounded-full'[m
             />[m
[31m-        </label>[m
[32m+[m[32m        }[m
         </div>[m
     )[m
 }[m
[1mdiff --git a/ui/src/components/Twits.js b/ui/src/components/Twits.js[m
[1mindex 3f9f47d..01cf676 100644[m
[1m--- a/ui/src/components/Twits.js[m
[1m+++ b/ui/src/components/Twits.js[m
[36m@@ -28,7 +28,7 @@[m [mexport default function Twits() {[m
 [m
     const {getState, dispatch} = store;[m
     const state = getState();[m
[31m-    const { twits, users } = useSelector(state => state);[m
[32m+[m[32m    const { twits, users, userData } = useSelector(state => state);[m
 [m
     const email = localStorage.getItem('email') ? localStorage.getItem('email') : '';[m
     const userId = localStorage.getItem('email') ? localStorage.getItem('userId') : '';[m
[36m@@ -79,7 +79,8 @@[m [mexport default function Twits() {[m
             url: `${apiUrl}`,[m
             headers: {[m
                 'Content-Type': 'application/json',[m
[31m-                'Authorization': `Bearer ${token}`[m
[32m+[m[32m                'Authorization': `Bearer ${token}`,[m
[32m+[m[32m                // 'Sec-Fetch-Site': 'cross-site'[m
             }[m
             })[m
             .catch(error => {[m
[36m@@ -119,10 +120,17 @@[m [mexport default function Twits() {[m
                 }[m
             });[m
             if(res && res.data.success) {[m
[32m+[m[32m                // console.log(res.data.data)[m
                 dispatch({[m
                     type: 'SET_USER_COUNT',[m
                     data: res.data.data.count[m
                 });[m
[32m+[m[32m                const userDataInStore = res.data.data.users.filter(obj => obj.email === email)[0];[m
[32m+[m[32m                // console.log(userDataInStore)[m
[32m+[m[32m                dispatch({[m
[32m+[m[32m                    type: 'SET_USER_DATA',[m
[32m+[m[32m                    data: userDataInStore[m
[32m+[m[32m                });[m
                 localStorage.setItem('userCount', res.data.data.count);[m
             } else {[m
                 setError('Error found');[m
[36m@@ -175,8 +183,8 @@[m [museEffect(() => {[m
         }, 0);[m
     }[m
     return () => {}[m
[31m-}, []);[m
[31m-[m
[32m+[m[32m}, [twits]);[m
[32m+[m[32m// console.log(userData)[m
 return ([m
     <div style={{fontFamily: 'Roboto', fontWeight: '600', height: '90vh'}} className='mb-5 p-3 m-auto flex justify-center md:w-1/2'>[m
             <span style={{cursor: 'pointer', borderRadius: '50%'}} className='text-xs mb-3 fixed bottom-7 right-2 bg-green-500 px-5 py-3 text-white'><RiChatNewLine size={25} onClick={showForm} />post</span>[m
[36m@@ -191,10 +199,11 @@[m [mreturn ([m
                     <span style={{fontSize: '1em'}}> Feel free, express yourself & network </span>[m
                 </p>[m
                 <div className='py-2 px-2 rounded mb-4 flex justify-between border-3 border shadow-md'>[m
[31m-                    {img !== 'null' ? ([m
[31m-                        <span className='cursor-pointer'  onClick= {e => history.push(`/${email.split('@')[0]}`)}>[m
[32m+[m[32m                    {/* {img !== 'null' ? ( */}[m
[32m+[m[32m                    {userData?.imageUrl ? ([m
[32m+[m[32m                        <span className='cursor-pointer'  onClick= {e => history.push(`/${userData.username}`)}>[m
                             {error ? <BsPersonFill size={25} />:[m
[31m-                            <img src={img} alt='Profile' style={{width: '30px', height: '30px', borderRadius: '50%'}} />}[m
[32m+[m[32m                            <img src={userData?.imageUrl} alt='Profile' style={{width: '30px', height: '30px', borderRadius: '50%'}} />}[m
                         </span>) [m
                         : <span className='text-left cursor-pointer'><BsPersonFill size={25} onClick={e => history.push(`/${email.split('@')[0]}`)} /></span>}[m
                     {users > 0 && <span className='text-left flex cursor-pointer'  onClick= {e => history.push('people')}><IoIosPeople size={30}/><span className='pt-1 pl-1'>{users}</span></span>}[m
[1mdiff --git a/ui/src/redux/actions.js b/ui/src/redux/actions.js[m
[1mindex 37c4d99..77429b9 100644[m
[1m--- a/ui/src/redux/actions.js[m
[1m+++ b/ui/src/redux/actions.js[m
[36m@@ -4,6 +4,7 @@[m [mconst actions = {[m
     setUserCount: { type: 'SET_USER_COUNT'},[m
     setPeopleData: { type: 'SET_PEOPLE_DATA'},[m
     setSearchData: { type: 'SET_SEARCH_DATA'},[m
[32m+[m[32m    setUserData: { type: 'SET_USER_DATA'},[m
     setUsersData: { type: 'SET_USERS_DATA'},[m
     setNewsType: { type: 'SET_NEWS_TYPE'},[m
     setPage: { type: 'SET_PAGE'},[m
[1mdiff --git a/ui/src/redux/reducer.js b/ui/src/redux/reducer.js[m
[1mindex dcab478..eba570e 100644[m
[1m--- a/ui/src/redux/reducer.js[m
[1m+++ b/ui/src/redux/reducer.js[m
[36m@@ -26,6 +26,12 @@[m [mexport default function reducer(state= initialState, action) {[m
               ...state,[m
               searchData: action.data[m
             }          [m
[32m+[m[32m        case actions.setUserData.type:[m
[32m+[m
[32m+[m[32m            return {[m
[32m+[m[32m              ...state,[m
[32m+[m[32m              userData: action.data[m
[32m+[m[32m            }[m[41m          [m
         case actions.setUsersData.type:[m
 [m
             return {[m
[36m@@ -90,6 +96,7 @@[m [mexport const initialState = {[m
     users: 0,[m
     peopleData: [],[m
     searchData: [],[m
[32m+[m[32m    userData: {},[m
     usersData: [],[m
     searchQuery: '',[m
     networkStatus: false[m
